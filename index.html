<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Compositor Chase Em</title>
  <link rel="stylesheet" href="styles/main.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400&family=Lora:wght@400;700&family=Merriweather:wght@400;700&family=Crimson+Text:wght@400;600&family=Playfair+Display:wght@400;700&family=Libre+Baskerville:wght@400;700&family=EB+Garamond:wght@400;600&family=PT+Serif:wght@400;700&family=Inter:wght@400;600&family=Roboto:wght@400;500&family=Open+Sans:wght@400;600&family=Lato:wght@400;700&family=Montserrat:wght@400;600&family=Source+Sans+Pro:wght@400;600&family=Poppins:wght@400;600&family=Raleway:wght@400;600&family=Work+Sans:wght@400;600&family=Roboto+Mono:wght@400&family=Source+Code+Pro:wght@400&family=Fira+Code:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- Padding handled in main.css for better control -->
</head>
<body>
  <div class="app-wrapper">
    <div class="container">
      <header>
        <div class="header-top">
          <h1>Compositor</h1>
          <div class="header-right">
            <a href="#" id="readMeLinkFixed" class="read-me-link">Read me</a>
          </div>
        </div>
      </header>

      <form id="layoutForm">
      <section class="form-section">
        <div class="unit-toggle-wrapper">
          <label class="unit-toggle-label">
            <span class="unit-option unit-option-mm">mm</span>
            <span class="unit-toggle-container">
              <input type="checkbox" id="marginUnitToggle" class="unit-toggle-input" checked>
              <span class="unit-toggle-slider"></span>
            </span>
            <span class="unit-option unit-option-em">em</span>
          </label>
        </div>
        <h2>Page Dimensions</h2>
        <div class="form-row">
          <div class="form-group">
            <label for="paperSizeSelect">Paper size</label>
            <select id="paperSizeSelect" class="paper-size-select">
              <option value="">Custom</option>
            </select>
          </div>
          <div class="form-group">
            <label>Orientation</label>
            <div class="unit-toggle-wrapper">
              <label class="unit-toggle-label">
                <span class="unit-option unit-option-portrait" title="Portrait">
                  <span class="material-icons">crop_portrait</span>
                </span>
                <span class="unit-toggle-container">
                  <input type="checkbox" id="orientationToggle" class="unit-toggle-input">
                  <span class="unit-toggle-slider"></span>
                </span>
                <span class="unit-option unit-option-landscape" title="Landscape">
                  <span class="material-icons">crop_landscape</span>
                </span>
              </label>
            </div>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="pageWidth">Width (mm)</label>
            <input type="number" id="pageWidth" value="210" class="input-small" required>
          </div>
          <div class="form-group">
            <label for="pageHeight">Height (mm)</label>
            <input type="number" id="pageHeight" value="297" class="input-small" required>
          </div>
        </div>
        <div class="form-row form-row-single-col">
          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" id="facingPages" class="checkbox-input">
              <span>Facing pages (book layout)</span>
            </label>
            <span class="helper-text">Enable for book layouts with inner and outer margins</span>
          </div>
        </div>
      </section>

      <section class="form-section">
        <h2>Margins</h2>
        <div class="form-row">
          <div class="form-group">
            <label for="topMargin" id="topMarginLabel">Top (mm)</label>
            <input type="number" id="topMargin" value="20" class="input-small" required>
            <span class="helper-text" id="topMarginConversion"></span>
          </div>
          <div class="form-group">
            <label for="bottomMargin" id="bottomMarginLabel">Bottom (mm)</label>
            <input type="number" id="bottomMargin" value="20" class="input-small" required>
            <span class="helper-text" id="bottomMarginConversion"></span>
          </div>
        </div>
        <!-- Single page margins -->
        <div id="singlePageMargins" class="form-row">
          <div class="form-group">
            <label for="leftMargin" id="leftMarginLabel">Left (mm)</label>
            <input type="number" id="leftMargin" value="20" class="input-small" required>
            <span class="helper-text" id="leftMarginConversion"></span>
          </div>
          <div class="form-group">
            <label for="rightMargin" id="rightMarginLabel">Right (mm)</label>
            <input type="number" id="rightMargin" value="20" class="input-small" required>
            <span class="helper-text" id="rightMarginConversion"></span>
          </div>
        </div>
        <!-- Facing pages margins -->
        <div id="facingPagesMargins" class="form-row" style="display: none;">
          <div class="form-group">
            <label class="page-label"><a href="#" class="page-link" data-term="verso">Verso</a></label>
            <label for="innerMarginLeft" id="innerMarginLeftLabel">Inner (mm)</label>
            <input type="number" id="innerMarginLeft" value="20" class="input-small" required>
            <span class="helper-text" id="innerMarginLeftConversion"></span>
            <label for="outerMarginLeft" id="outerMarginLeftLabel">Outer (mm)</label>
            <input type="number" id="outerMarginLeft" value="20" class="input-small" required>
            <span class="helper-text" id="outerMarginLeftConversion"></span>
          </div>
          <div class="form-group">
            <label class="page-label"><a href="#" class="page-link" data-term="recto">Recto</a></label>
            <label for="innerMarginRight" id="innerMarginRightLabel">Inner (mm)</label>
            <input type="number" id="innerMarginRight" value="20" class="input-small" required>
            <span class="helper-text" id="innerMarginRightConversion"></span>
            <label for="outerMarginRight" id="outerMarginRightLabel">Outer (mm)</label>
            <input type="number" id="outerMarginRight" value="20" class="input-small" required>
            <span class="helper-text" id="outerMarginRightConversion"></span>
          </div>
        </div>
        <div id="facingPagesMarginsOuter" class="form-row" style="display: none;">
        </div>
      </section>

      <section class="form-section">
        <h2>Columns</h2>
        <div class="form-row">
          <div class="form-group">
            <label for="numCols">Number of columns</label>
            <input type="number" id="numCols" value="2" min="1" class="input-small" required>
          </div>
          <div class="form-group">
            <label for="gutterWidth" id="gutterWidthLabel">Gutter width (em)</label>
            <input type="number" id="gutterWidth" value="" step="0.001" class="input-small" required>
            <span class="helper-text" id="gutterWidthConversion"></span>
          </div>
        </div>
        <div class="form-group">
          <span id="columnWidthDisplay" class="helper-text"></span>
          <span id="autoGutterNote" class="helper-text"></span>
        </div>
        <div class="form-group">
          <label for="columnSpanSlider">Text box spans columns</label>
          <div class="slider-container">
            <input type="range" id="columnSpanSlider" min="1" max="2" value="2" class="slider-input">
            <span id="columnSpanValue" class="slider-value">2</span>
          </div>
          <span class="helper-text">Number of columns the text box should span</span>
        </div>
        <div class="form-group">
          <label for="textStartSlider">Text starts</label>
          <div class="slider-container">
            <input type="range" id="textStartSlider" min="1" max="2" value="1" class="slider-input">
            <span id="textStartValue" class="slider-value">1</span>
          </div>
          <span class="helper-text">Column where text begins</span>
        </div>
      </section>

      <section class="form-section">
        <h2>Typography Settings</h2>
        <div class="form-group">
          <label for="fontFamily">Typeface</label>
          <select id="fontFamily" class="font-select">
            <option value="serif">Serif (default)</option>
            <option value="Georgia">Georgia</option>
            <option value="Times New Roman">Times New Roman</option>
            <option value="Lora">Lora</option>
            <option value="Merriweather">Merriweather</option>
            <option value="Crimson Text">Crimson Text</option>
            <option value="Playfair Display">Playfair Display</option>
            <option value="Libre Baskerville">Libre Baskerville</option>
            <option value="EB Garamond">EB Garamond</option>
            <option value="PT Serif">PT Serif</option>
            <option value="sans-serif">Sans-serif (default)</option>
            <option value="Inter">Inter</option>
            <option value="Roboto">Roboto</option>
            <option value="Open Sans">Open Sans</option>
            <option value="Lato">Lato</option>
            <option value="Montserrat">Montserrat</option>
            <option value="Source Sans Pro">Source Sans Pro</option>
            <option value="Poppins">Poppins</option>
            <option value="Raleway">Raleway</option>
            <option value="Work Sans">Work Sans</option>
            <option value="monospace">Monospace (default)</option>
            <option value="Courier New">Courier New</option>
            <option value="Roboto Mono">Roboto Mono</option>
            <option value="Source Code Pro">Source Code Pro</option>
            <option value="Fira Code">Fira Code</option>
          </select>
          <span class="helper-text">Select a typeface for text preview</span>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="typeSize">Type size (pt)</label>
            <input type="number" id="typeSize" value="12" class="input-small" required>
          </div>
          <div class="form-group">
            <label for="leading">Leading (pt)</label>
            <input type="number" id="leading" value="" step="0.1" class="input-small" required>
          </div>
        </div>
        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" id="hyphenation" class="checkbox-input">
            <span>Enable hyphenation</span>
          </label>
          <span class="helper-text">Automatically hyphenate words at line breaks</span>
        </div>
        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" id="justifyText" class="checkbox-input">
            <span>Justify text</span>
          </label>
          <span class="helper-text">Align text to both left and right</span>
        </div>
      </section>

      <section class="form-section">
        <h2>Sample Text</h2>
        <div class="form-group">
          <div class="label-with-action">
            <label for="sampleText">Text preview</label>
            <div class="text-actions">
              <button type="button" id="loadDefaultTextButton" class="btn-link">Load default text</button>
              <span class="text-action-separator">|</span>
              <button type="button" id="clearTextButton" class="btn-link">Clear</button>
            </div>
          </div>
          <textarea id="sampleText" rows="4" placeholder="Enter sample text to preview how it will look in your layout..."></textarea>
          <span class="helper-text">Preview how your text will appear in the calculated columns</span>
        </div>
      </section>

      <section class="form-section bringhurst-section">
        <h2>Bringhurst says</h2>
        <div class="form-group">
          <div class="info-display">
            <span class="info-label">Words per line:</span>
            <span id="wordsPerLine" class="info-value">—</span>
          </div>
          <span class="helper-text" id="bringhurstGuidance">Estimated based on column width and type size</span>
        </div>
        <div class="form-group">
          <div class="info-display">
            <span class="info-label">Leading:</span>
            <span id="bringhurstLeading" class="info-value">—</span>
          </div>
          <span class="helper-text" id="bringhurstLeadingGuidance">Recommended leading values</span>
        </div>
      </section>
      </form>
    </div>

    <div class="preview-wrapper">
      <section class="visualization-section">
        <div class="section-header">
          <h2>Chase</h2>
          <div class="header-actions">
            <span id="scaleIndicator" class="scale-indicator"></span>
                  <button type="button" id="exportHtmlButton" class="btn-export">Export to PDF</button>
          </div>
        </div>
        <div class="layer-controls">
          <label class="layer-checkbox">
            <input type="checkbox" id="showMargins" checked>
            <span>Margins</span>
          </label>
          <label class="layer-checkbox">
            <input type="checkbox" id="showColumns" checked>
            <span>Columns</span>
          </label>
          <label class="layer-checkbox">
            <input type="checkbox" id="showText" checked>
            <span>Text</span>
          </label>
          <label class="layer-checkbox">
            <input type="checkbox" id="solidFills">
            <span>Solid fills</span>
          </label>
          <label class="layer-checkbox">
            <input type="checkbox" id="showRaggedEdge">
            <span>Ragged edge</span>
          </label>
        </div>
        <div id="visualizationContainer" class="visualization-container"></div>
      </section>
      
      <div class="specification-section">
        <h3>Specification</h3>
        <div id="specificationContent" class="specification-content"></div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="introModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Compositor Chase Em</h2>
        <button type="button" id="closeModal" class="modal-close" aria-label="Close modal">&times;</button>
      </div>
      <div class="modal-body">
        <p class="modal-intro">A typographic layout calculator for designing multi-column page layouts. Set page dimensions, margins, columns, and typography settings to visualize and calculate optimal column widths, text box spans, and line lengths based on Bringhurst's principles of typography.</p>
        
        <div class="modal-section">
          <h3 class="modal-section-title">Compositor</h3>
          <p class="modal-section-text">In letterpress printing, a compositor is the person who arranges type and spacing elements to create a page layout. They work at a composing stick, selecting individual pieces of type and spacing material (furniture, leads, and reglets) to build up lines and pages before locking them into a chase.</p>
          <p class="modal-section-links">
            <a href="https://en.wikipedia.org/wiki/Compositor_(typesetting)" target="_blank" rel="noopener noreferrer">Wikipedia: Compositor</a> · 
            <a href="https://www.flickr.com/search/?text=compositor%20letterpress" target="_blank" rel="noopener noreferrer">Images</a>
          </p>
        </div>
        
        <div class="modal-section">
          <h3 class="modal-section-title">Chase</h3>
          <p class="modal-section-text">A chase is a rectangular metal frame used in letterpress printing to hold the composed type and spacing material securely in place. Once the compositor has arranged all the elements, they are locked into the chase using quoins (wedges) and keys, creating a stable form ready for printing.</p>
          <p class="modal-section-links">
            <a href="https://en.wikipedia.org/wiki/Chase_(printing)" target="_blank" rel="noopener noreferrer">Wikipedia: Chase</a> · 
            <a href="https://www.flickr.com/search/?text=chase%20letterpress" target="_blank" rel="noopener noreferrer">Images</a>
          </p>
        </div>
        
        <div class="modal-section">
          <h3 class="modal-section-title">Em</h3>
          <p class="modal-section-text">An em is a typographic unit equal to the current font size. For example, if your type size is 12pt, then 1em = 12pt. Ems are relative units that scale with the font size, making them ideal for spacing elements like gutters and margins in typography.</p>
          <p class="modal-section-links">
            <a href="https://en.wikipedia.org/wiki/Em_(typography)" target="_blank" rel="noopener noreferrer">Wikipedia: Em</a> · 
            <a href="https://practicaltypography.com/em-and-en-dashes.html" target="_blank" rel="noopener noreferrer">Practical Typography</a>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Term Modal -->
  <div id="termModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="termModalTitle"></h2>
        <button class="modal-close" id="termModalClose">&times;</button>
      </div>
      <div class="modal-body">
        <div id="termModalContent"></div>
      </div>
    </div>
  </div>

  <footer class="fixed-footer" id="footer">
    <div class="fixed-footer-content">
      <h1 class="footer-menu-toggle" id="footerMenuToggle">Menu</h1>
      <div class="footer-content-wrapper">
        <h1>This a a GD v/x AI Project. PkWr 2025. A growing typographic resource for education. <i>What you don't have to do, you won't need to know, so who will be lost</i></h1>
        <nav class="footer-nav">
          <div class="footer-nav-item">
            <a href="index.html" class="footer-nav-link">Compositor</a>
            <p class="footer-nav-description">Typography layout calculator for designing multi-column page layouts with margins, columns, and typography settings.</p>
          </div>
          <div class="footer-nav-item">
            <a href="grep.html" class="footer-nav-link">Grep</a>
            <p class="footer-nav-description">Generate InDesign GREP patterns for paragraph styles to find specific words, digits, punctuation, or enclosed content.</p>
          </div>
          <div class="footer-nav-item">
            <a href="#" class="footer-nav-link">Hierarchy</a>
            <p class="footer-nav-description">Coming soon.</p>
          </div>
          <div class="footer-nav-item">
            <label class="footer-sparkle-label">
              <input type="checkbox" id="sparkleToggle" class="checkbox-input">
              <span class="footer-nav-link" style="text-decoration: none; margin-bottom: 0;">Sparkle</span>
            </label>
          </div>
        </nav>
      </div>
    </div>
  </footer>

  <!-- PDF Export Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script type="module" src="dist/main.js"></script>
</body>
</html>